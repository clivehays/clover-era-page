<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Retention Reality Roundtable | Clover ERA</title>
    <meta name="description" content="A 60-minute conversation for managers tired of being surprised by resignations and blamed for departures they saw coming.">

    <style>
        :root {
            --teal: #46AEB8;
            --deep-teal: #0D7C88;
            --charcoal: #1F2937;
            --white: #FFFFFF;
            --light-gray: #F8F9FA;
            --medium-gray: #E5E7EB;
            --text-primary: #111827;
            --text-secondary: #4B5563;
            --yellow: #FFD93D;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--deep-teal), var(--teal));
            color: var(--white);
            padding: 4rem 2rem 4rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .hero .subheadline {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.3;
        }

        .hero .description {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            opacity: 0.95;
            line-height: 1.7;
        }

        .btn-primary {
            background: var(--charcoal);
            color: var(--white);
            padding: 1.2rem 3rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            display: inline-block;
            margin: 1rem 0.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* Content Sections */
        .section {
            padding: 4rem 2rem;
            max-width: 900px;
            margin: 0 auto;
        }

        .section-alt {
            background: var(--light-gray);
        }

        .section h2 {
            font-size: 2.2rem;
            margin-bottom: 2rem;
            color: var(--charcoal);
            font-weight: 700;
        }

        .section h3 {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            color: var(--deep-teal);
            font-weight: 600;
        }

        .section p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .items-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .item {
            padding: 2rem;
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .item h3 {
            margin-top: 0;
        }

        ul {
            list-style: none;
            padding-left: 0;
            margin: 1.5rem 0;
        }

        ul li {
            padding: 0.8rem 0 0.8rem 2rem;
            position: relative;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        ul li:before {
            content: "â€¢";
            position: absolute;
            left: 0.5rem;
            color: var(--teal);
            font-weight: bold;
            font-size: 1.5rem;
        }

        .qualification-list {
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
        }

        .disqualification {
            background: #FFF3E0;
            padding: 1.5rem;
            border-left: 4px solid #FF9800;
            margin: 2rem 0;
            border-radius: 4px;
        }

        .bio-section {
            display: flex;
            gap: 2rem;
            align-items: start;
            margin: 2rem 0;
        }

        .bio-text {
            flex: 1;
        }

        .next-cohort {
            background: linear-gradient(135deg, var(--deep-teal), var(--teal));
            color: var(--white);
            padding: 2.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
        }

        .next-cohort.cohort-full {
            background: linear-gradient(135deg, #6B7280, #9CA3AF);
        }

        .next-cohort h3 {
            color: var(--white);
            margin-top: 0;
        }

        .next-cohort p {
            color: var(--white);
            opacity: 0.95;
            margin: 0.5rem 0;
            font-size: 1.15rem;
        }

        .cohort-detail {
            display: flex;
            margin: 0.8rem 0;
        }

        .availability-badge {
            display: inline-block;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-left: 1rem;
        }

        .badge-available {
            background: #10B981;
            color: white;
        }

        .badge-limited {
            background: #F59E0B;
            color: white;
        }

        .badge-full {
            background: #EF4444;
            color: white;
        }

        .cohort-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .cohort-date-large {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .cohort-label {
            font-weight: 700;
            min-width: 100px;
        }

        .faq-item {
            margin: 2rem 0;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--medium-gray);
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--charcoal);
            margin-bottom: 1rem;
        }

        .faq-answer {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .final-cta {
            text-align: center;
            padding: 5rem 2rem;
            background: linear-gradient(135deg, var(--charcoal), var(--deep-teal));
            color: var(--white);
        }

        .final-cta h2 {
            color: var(--white);
            font-size: 2.5rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero .subheadline {
                font-size: 1.3rem;
            }

            .hero .description {
                font-size: 1.1rem;
            }

            .section h2 {
                font-size: 1.8rem;
            }

            .bio-section {
                flex-direction: column;
            }

            .btn-primary {
                padding: 1rem 2rem;
                font-size: 1rem;
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <!-- Hero Section -->
    <section class="hero">
        <h1>The Retention Reality Roundtable</h1>
        <p class="subheadline">Where managers talk about what's actually happening.<br>Not what they tell HR.</p>
        <p class="description">
            60 minutes. 8 people. The conversation you can't have at your company.
        </p>
        <p class="description">
            This isn't a webinar. It's 8 managers from different companies talking about what's actually happening on their teams.
        </p>
        <a href="#upcoming-sessions" class="btn-primary">Apply for the Next Session</a>
    </section>

    <!-- What You'll Get -->
    <section class="section">
        <h2>What You'll Leave With</h2>
        <div class="items-grid">
            <div class="item">
                <h3>The Signals That Show Up Before Resignation</h3>
                <p>What changes in the 60-90 days before someone gives notice. The patterns are consistent. Most managers miss them because nobody taught them what to watch for.</p>
            </div>
            <div class="item">
                <h3>Language for Escalating Without Getting Blamed</h3>
                <p>How to tell leadership someone's a flight risk without it becoming your problem.</p>
            </div>
            <div class="item">
                <h3>What's Actually Working</h3>
                <p>Real moves from real managers. The stuff that never makes it into an HR playbook but actually works.</p>
            </div>
        </div>
    </section>

    <!-- Format -->
    <section class="section section-alt">
        <h2>How It Works</h2>
        <p><strong>60 minutes. 8 people. Real conversation.</strong></p>
        <p>No slides. No pitch. No HR-approved talking points.</p>
        <p>Chatham House rules: Share what you learn, never who said it.</p>
        <p>Facilitated by Clive Hays. 20 years at Fortune 500 companies watching leadership obsess over efficiency while managers watched their best people leave. He co-founded Clover ERA to close that gap.</p>
    </section>

    <!-- Who This Is For -->
    <section class="section">
        <h2>This Is For You If...</h2>
        <div class="qualification-list">
            <ul>
                <li>You manage a team at a company with 100+ employees</li>
                <li>You've had someone resign in the last year and didn't see it coming</li>
                <li>You've tried to escalate retention concerns and nothing changed</li>
                <li>You're tired of being surprised by departures and blamed when they happen</li>
            </ul>
        </div>
        <div class="disqualification">
            <strong>This isn't for HR professionals, consultants, or anyone looking to sell to the group. Managers only.</strong>
        </div>
    </section>

    <!-- About the Facilitator -->
    <section class="section section-alt">
        <h2>Who's Running This</h2>
        <div class="bio-section">
            <div class="bio-text">
                <p>Clive Hays spent 20 years at Fortune 500 companies implementing transformation programs. He watched leadership obsess over operational efficiency while managers watched their best people walk out the door.</p>
                <p>That gap - between what leadership tracks and what managers see - is what led him to co-found Clover ERA and co-author The Trillion Dollar Problem.</p>
                <p>His writing on retention has reached over 1 Million people this month. Most of them are managers who've been told to "manage expectations" when they flagged a flight risk.</p>
                <p>This roundtable is where those managers finally get to talk.</p>
            </div>
        </div>
    </section>

    <!-- Upcoming Cohorts -->
    <section class="section" id="upcoming-sessions">
        <h2>Upcoming Roundtables</h2>
        <div id="cohorts-container">
            <div class="next-cohort" style="opacity: 0.7;">
                <p style="text-align: center;">Loading upcoming sessions...</p>
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section class="section section-alt">
        <h2>FAQ</h2>

        <div class="faq-item">
            <div class="faq-question">Q: Why is this free?</div>
            <div class="faq-answer">A: Because the real value is meeting managers who are living this. Some of you will want to introduce these ideas to your leadership. Some won't. You'll leave with something useful regardless.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Q: Why do I need to apply?</div>
            <div class="faq-answer">A: To keep the group small and relevant. This only works if everyone in the room is a manager dealing with real retention challenges. No consultants, no vendors, no observers.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Q: Will this be recorded?</div>
            <div class="faq-answer">A: No. This is a safe space where managers can speak openly about what's really happening on their teams. No recordings, no transcripts. What's said in the room stays in the room.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Q: What if I can't make any of the scheduled times?</div>
            <div class="faq-answer">A: Apply anyway and select "No" for availability. I'll add you to our list and reach out when we schedule sessions that work better for your timezone or calendar.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Q: Is this a sales pitch for Clover ERA?</div>
            <div class="faq-answer">A: No. I'll mention what we do if it's relevant, but this isn't a demo or a pitch session. The roundtable is valuable on its own.</div>
        </div>
    </section>

    <!-- Final CTA -->
    <section class="final-cta">
        <h2>Ready to Talk About What's Actually Happening?</h2>
        <a href="#upcoming-sessions" class="btn-primary">Apply for the Next Session</a>
    </section>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://dvvsphsvcpxkplumutyc.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR2dnNwaHN2Y3B4a3BsdW11dHljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwMDc3MzksImV4cCI6MjA3OTU4MzczOX0.waQs1wvf4Er66Oe-NI5Ht0M-tHJk83St1UR8AT2dOeI';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Format time for display (e.g., "12:00 PM EST")
        function formatTime(timeStr, timezone) {
            // Parse time string (e.g., "12:00:00" or "12:00")
            const parts = timeStr.split(':');
            let hours = parseInt(parts[0], 10);
            const minutes = parts[1] || '00';
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;

            // Simplify timezone display
            const tzMap = {
                'America/New_York': 'EST',
                'America/Chicago': 'CST',
                'America/Denver': 'MST',
                'America/Los_Angeles': 'PST',
                'UTC': 'UTC'
            };
            const tzShort = tzMap[timezone] || timezone;

            return `${hours}:${minutes} ${ampm} ${tzShort}`;
        }

        // Load cohorts with availability
        async function loadCohortInfo() {
            const container = document.getElementById('cohorts-container');

            try {
                // Get upcoming cohorts (limit to 4 to show mix of available and full)
                const { data: cohorts, error: cohortsError } = await supabaseClient
                    .from('roundtable_cohorts')
                    .select('*')
                    .eq('status', 'upcoming')
                    .order('date', { ascending: true })
                    .limit(4);

                if (cohortsError) throw cohortsError;

                if (!cohorts || cohorts.length === 0) {
                    container.innerHTML = `
                        <div class="next-cohort">
                            <h3>Next Cohort Coming Soon</h3>
                            <p>We're scheduling our next roundtable. Apply now to be notified when dates are announced.</p>
                        </div>
                    `;
                    return;
                }

                // Get accepted application counts for each cohort
                const cohortIds = cohorts.map(c => c.id);
                const { data: appCounts, error: appError } = await supabaseClient
                    .from('roundtable_applications')
                    .select('cohort_id')
                    .in('cohort_id', cohortIds)
                    .eq('status', 'accepted');

                // Count accepted applications per cohort
                const acceptedCounts = {};
                if (appCounts) {
                    appCounts.forEach(app => {
                        acceptedCounts[app.cohort_id] = (acceptedCounts[app.cohort_id] || 0) + 1;
                    });
                }

                // Separate cohorts into available and full
                const cohortsWithAvailability = cohorts.map(cohort => {
                    const accepted = acceptedCounts[cohort.id] || 0;
                    const spotsRemaining = cohort.is_full ? 0 : (cohort.max_attendees - accepted);
                    return { ...cohort, accepted, spotsRemaining };
                });

                const availableCohorts = cohortsWithAvailability.filter(c => c.spotsRemaining > 0 && !c.is_full);
                const fullCohorts = cohortsWithAvailability.filter(c => c.spotsRemaining <= 0 || c.is_full);

                // Show up to 2 available cohorts, then any full ones
                const cohortsToShow = [...availableCohorts.slice(0, 2), ...fullCohorts.slice(0, 2)].slice(0, 3);

                // Generate HTML
                let html = '';
                cohortsToShow.forEach(cohort => {
                    const date = new Date(cohort.date);
                    const dateStr = date.toLocaleDateString('en-US', {
                        weekday: 'long',
                        month: 'long',
                        day: 'numeric',
                        year: 'numeric'
                    });
                    const timeStr = formatTime(cohort.time, cohort.timezone);
                    const isFull = cohort.is_full || cohort.spotsRemaining <= 0;
                    const isLimited = !isFull && cohort.spotsRemaining <= 3 && cohort.spotsRemaining > 0;

                    let badgeHtml = '';
                    if (isFull) {
                        badgeHtml = '<span class="availability-badge badge-full">FULL</span>';
                    } else if (isLimited) {
                        badgeHtml = `<span class="availability-badge badge-limited">${cohort.spotsRemaining} spots left</span>`;
                    } else {
                        badgeHtml = `<span class="availability-badge badge-available">${cohort.spotsRemaining} spots available</span>`;
                    }

                    html += `
                        <div class="next-cohort ${isFull ? 'cohort-full' : ''}">
                            <div class="cohort-header">
                                <span class="cohort-date-large">${dateStr}</span>
                                ${badgeHtml}
                            </div>
                            <div class="cohort-detail">
                                <span class="cohort-label">Time:</span>
                                <span>${timeStr}</span>
                            </div>
                            <div class="cohort-detail">
                                <span class="cohort-label">Format:</span>
                                <span>60-minute video call with 8 people</span>
                            </div>
                            ${!isFull ? `<a href="apply/?cohort=${cohort.id}" class="btn-primary" style="margin-top: 1rem;">Apply for This Session</a>` : ''}
                        </div>
                    `;
                });

                container.innerHTML = html;

            } catch (error) {
                console.error('Error loading cohort info:', error);
                container.innerHTML = `
                    <div class="next-cohort">
                        <h3>Next Cohort Coming Soon</h3>
                        <p>Check back soon for upcoming session dates, or apply now to be notified.</p>
                    </div>
                `;
            }
        }

        // Load cohort info on page load
        loadCohortInfo();
    </script>

</body>
</html>
